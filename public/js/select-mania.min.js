/*! select-mania v1.0.5 */
!function(e){var a={defaults:{width:"100%",size:"medium",themes:[],placeholder:"Select an item",removable:!1,empty:!1,search:!1,ajax:!1,data:{}},setup:function(t){var i=Object.keys(this.defaults),n=!0;Object.keys(t).forEach(function(a){-1===e.inArray(a,i)&&(console.error("selectMania | wrong setup settings"),n=!1)}),n&&(this.defaults=e.extend(!0,{},a.defaults,t))}},t={internalSettings:function(e,a){return a.multiple=!1,a.values=[],a.multiple=e.is("[multiple]"),e.find("option:selected").each(function(){a.values.push({value:this.value,text:this.text})}),a},getAttrSettings:function(e){var a={};return["width","size","placeholder","removable","empty","search"].forEach(function(t){if(e.is("[data-"+t+"]")){var i=e.attr("data-"+t);"true"!==i&&"false"!==i||(i="true"===i),a[t]=i}}),a},initialize:function(a,t){var l=this,s=e.extend(!0,{},t),c=l.getAttrSettings(a);if((s=e.extend(s,c)).empty&&a.val(""),s=l.internalSettings(a,s),l.controlSettings(a,s,["ajax","size"])){var o=i.build(a,s);o.data("selectMania-originalSelect",a),a.data("selectMania-element",o),!1!==s.ajax&&l.initAjax(o,s),l.updateClean(o),a.addClass("select-mania-original"),o.insertBefore(a),n.bind(o)}},update:function(a){var t=this;$selectManiaEl=a.data("selectMania-element"),$valueList=$selectManiaEl.find(".select-mania-values").first(),$itemList=$selectManiaEl.find(".select-mania-items").first(),$selectManiaEl.find(".select-mania-value").remove(),$itemList.empty(),a.find("option:selected").each(function(){e(this).is(":selected")&&$valueList.append(i.buildValue({value:this.value,text:this.text}))}),$itemList.append(i.buildItemList(a.children())),t.updateClean($selectManiaEl),n.bind($selectManiaEl)},destroy:function(e){$selectManiaEl=e.data("selectMania-element"),$selectManiaEl.remove(),e.removeClass("select-mania-original")},openDropdown:function(e){var a=this;e.stop().addClass("open").slideDown(100),a.focusSearch(e)},closeDropdown:function(e){e.stop().removeClass("open").slideUp(100)},focusSearch:function(e){e.find(".select-mania-dropdown-search-input").focus()},addMultipleVal:function(e,a){var t=e.val();t instanceof Array||(t=[]),t.push(a),e.val(t)},removeMultipleVal:function(a,t){var i=a.val();i instanceof Array||(i=[]),i.splice(e.inArray(t,i),1),a.val(i)},updateClean:function(e){var a=e.data("selectMania-originalSelect");null!==a.val()&&a.val().length>0?e.find(".select-mania-clear-icon").show():e.find(".select-mania-clear-icon").hide()},doSearch:function(a){var t=a.find(".select-mania-dropdown-search-input").first().val();""!==(t=t.toLowerCase().trim())?(a.find(".select-mania-item").each(function(){-1!==e(this).text().toLowerCase().indexOf(t)?e(this).removeClass("select-mania-hidden"):e(this).addClass("select-mania-hidden")}),a.find(".select-mania-group").each(function(){e(this).find(".select-mania-item:not(.select-mania-hidden)").length>0?e(this).removeClass("select-mania-hidden"):e(this).addClass("select-mania-hidden")})):a.find(".select-mania-group, .select-mania-item").removeClass("select-mania-hidden")},doSearchAjax:function(e){var a=this,i=e.find(".select-mania-dropdown-search-input").first().val();e.data("selectMania-ajaxReady",!1),e.data("selectMania-ajaxPage",1),a.dropdownLoading(e),e.data("selectMania-ajaxFunction")(i,1,e.data("selectMania-ajaxData"),function(i){a.dropdownLoading(e,!0),t.replaceItems(e,i),n.bind(e),a.initAjax(e)})},addItems:function(e,a){this.addOrReplaceItems(e,a,!1)},replaceItems:function(e,a){this.addOrReplaceItems(e,a,!0)},addOrReplaceItems:function(a,t,l){var s=this,c=a.data("selectMania-originalSelect"),o=a.find(".select-mania-items"),r=e(t);s.getVal(a).forEach(function(a){r.filter(function(){return e(this).attr("value")===a.value&&e(this).text()===a.text}).prop("selected",!0)}),$builtItems=i.buildItemList(r),!0===l&&(c.find("option").remove(":not(:checked)"),o.empty()),o.append($builtItems),c.append(r),n.bind(a)},initAjax:function(e,a){"object"==typeof a&&(a.hasOwnProperty("ajax")&&"function"==typeof a.ajax&&e.data("selectMania-ajaxFunction",a.ajax),a.hasOwnProperty("data")&&"object"==typeof a.data&&e.data("selectMania-ajaxData",a.data)),e.data("selectMania-ajaxPage",1),e.data("selectMania-ajaxReady",!0),e.data("selectMania-ajaxScrollDone",!1)},dropdownLoading:function(a,t){var i=!1;if(void 0!==t&&!0===t&&(i=!0),$dropdownContainer=a.find(".select-mania-items-container").first(),$dropdownContainer.find(".icon-loading-container").remove(),!0!==i){var n=e('<div class="icon-loading-container"></div>');n.append('<i class="icon-loading"></i>'),$dropdownContainer.append(n)}},getVal:function(a){var t=[];return a.find(".select-mania-value").each(function(){var a=e(this).find(".select-mania-value-text").first().text();t.push({value:e(this).attr("data-value"),text:a})}),t},clear:function(e){e.find(".select-mania-value").remove(),e.find(".select-mania-item").removeClass("select-mania-selected");var a=e.data("selectMania-originalSelect");e.is(".select-mania-multiple")?a.val([]):a.val("")},setVal:function(a,t){var i=this,l=a.data("selectMania-originalSelect");i.clear(a),t.length>1&&!a.is(".select-mania-multiple")&&(t=t.slice(0,1)),t.forEach(function(t){var n=e.extend({value:"",text:"",selected:!0},t);i.setOneValSelectMania(a,n),i.setOneValOriginal(l,n)}),i.updateClean(a),n.bind(a)},setOneValSelectMania:function(a,t){var n=i.buildValue(t);a.find(".select-mania-values").append(n);var l=a.find('.select-mania-item[data-value="'+t.value+'"]').filter(function(){return e(this).text()===t.text});l.length>0&&l.first().addClass("select-mania-selected")},setOneValOriginal:function(a,t){var n=a.find('option[value="'+t.value+'"]').filter(function(){return e(this).text()===t.text});if(n.length<1){var l=i.buildOption(t);a.append(l)}else n.first()[0].selected=!0},controlTarget:function(a,t){return-1===e.inArray("isSelect",t)||a.is("select")?-1===e.inArray("isInitialized",t)||a.hasClass("select-mania-original")?-1!==e.inArray("notInitialized",t)&&a.hasClass("select-mania-original")?(console.error("selectMania | ignore because already initialized"),console.log(a[0]),!1):!(-1!==e.inArray("isSingle",t)&&a.length>1)||(console.error("selectMania | check method can be called on single element only"),console.log(a[0]),!1):(console.error("selectMania | select is not initialized"),console.log(a[0]),!1):(console.error("selectMania | not a valid select element"),console.log(a[0]),!1)},controlSettings:function(a,t,i){return-1!==e.inArray("ajax",i)&&!1!==t.ajax&&"function"!=typeof t.ajax?(t.ajax=!1,console.error("selectMania | not a valid ajax function"),console.log(a[0]),console.log(t),!1):-1===e.inArray("size",i)||-1!==e.inArray(t.size,["small","medium","large"])||(t.size="medium",console.error("selectMania | not a valid size"),console.log(a[0]),console.log(t),!1)},controlValues:function(e,a){return a instanceof Array||(console.error("selectMania | values parameter is not a valid array"),console.log(e[0]),console.log(a),!1)}},i={build:function(a,t){var i=this,n="select-mania-"+t.size,l='style="width:'+t.width+';"',s=e('<div class="select-mania '+n+'" '+l+"></div>");return t.multiple&&s.addClass("select-mania-multiple"),t.themes instanceof Array&&t.themes.length>0&&t.themes.forEach(function(e){s.addClass("select-mania-theme-"+e)}),!1!==t.ajax&&s.addClass("select-mania-ajax"),s.append(i.buildInner(t)).append(i.buildDropdown(a,t)),s},buildInner:function(a){var t=this,i=e('<div class="select-mania-inner"></div>'),n=e('<div class="select-mania-values"></div>'),l=e('<div class="select-mania-placeholder">'+a.placeholder+"</div>");n.append(l),a.values.forEach(function(e){n.append(t.buildValue(e))}),i.append(n);var s=e('<div class="select-mania-clear"></div>');return(a.removable||a.multiple)&&s.append('<i class="select-mania-clear-icon icon-cross">'),i.append(s),i.append(e('<div class="select-mania-arrow"><i class="select-mania-arrow-icon icon-arrow-down"></i></div>')),i},buildValue:function(a){var t='<div class="select-mania-value" data-value="'+a.value+'"><div class="select-mania-value-text">'+a.text+'</div><div class="select-mania-value-clear"><i class="select-mania-value-clear-icon icon-cross"></i></div></div>';return e(t)},buildOption:function(a){var t=e('<option value="'+a.value+'">'+a.text+"</option>");return t[0].selected=a.selected,t},buildDropdown:function(a,t){var i=this,n=e('<div class="select-mania-dropdown"></div>');if(t.search){var l=e('<div class="select-mania-dropdown-search"></div>');l.append('<input class="select-mania-dropdown-search-input" />'),n.append(l)}var s=e('<div class="select-mania-items-container"></div>'),c=e('<div class="select-mania-items"></div>');return c.append(i.buildItemList(a.children())),s.append(c),n.append(s),n},buildItemList:function(a){var t=this;return $itemList=e(),a.each(function(){e(this).is("optgroup")?$itemList=$itemList.add(t.buildItemGroup(e(this))):e(this).is("option")&&($itemList=$itemList.add(t.buildItem(e(this))))}),$itemList},buildItemGroup:function(a){var t=this;$group=e('<div class="select-mania-group"></div>');var i=e('<div class="select-mania-group-inner"></div>'),n=e('<div class="select-mania-group-title"></div>');a.is("[data-icon]")&&n.append('<div class="select-mania-group-icon"><i class="'+a.attr("data-icon")+'"></i></div>'),n.append('<div class="select-mania-group-text">'+a.attr("label")+"</div>"),$group.append(n);var l=a.is(":disabled");return l&&$group.addClass("select-mania-disabled"),a.find("option").each(function(){i.append(t.buildItem(e(this),l))}),$group.append(i),$group},buildItem:function(a,t){var i=a[0],n=e('<div class="select-mania-item" data-value="'+i.value+'"></div>');return a.is("[data-icon]")&&n.append('<div class="select-mania-item-icon"><i class="'+a.attr("data-icon")+'"></i></div>'),n.append('<div class="select-mania-item-text">'+i.text+"</div>"),(a.is(":disabled")||!0===l.def(t))&&n.addClass("select-mania-disabled"),a.is(":selected")&&n.addClass("select-mania-selected"),n}},n={bind:function(a){var t=this;e(document).off("click.selectMania").on("click.selectMania",t.documentClick),a.find(".select-mania-clear-icon").off("click.selectMania").on("click.selectMania",t.clearValues),a.find(".select-mania-value-clear-icon").off("click.selectMania").on("click.selectMania",t.clearValue),a.find(".select-mania-inner").off("click.selectMania").on("click.selectMania",t.dropdownToggle),a.find(".select-mania-item:not(.select-mania-disabled)").off("click.selectMania").on("click.selectMania",t.selectItem),a.find(".select-mania-dropdown-search-input").off("input.selectMania").on("input.selectMania",t.inputSearch),a.find(".select-mania-items").off("wheel.selectMania").on("wheel.selectMania",t.scrollControl),a.is(".select-mania-ajax")&&a.find(".select-mania-items").off("scroll.selectMania").on("scroll.selectMania",t.scrollAjax)},dropdownToggle:function(){var a=e(this).closest(".select-mania").find(".select-mania-dropdown").first();a.is(".open")?t.closeDropdown(a):t.openDropdown(a)},documentClick:function(a){if(e(a.target).closest(".select-mania").length>0){var i=e(a.target).closest(".select-mania"),n=e(".select-mania").not(i).find(".select-mania-dropdown.open");t.closeDropdown(n)}else t.closeDropdown(e(".select-mania-dropdown.open"))},clearValues:function(a){a.stopPropagation();var i=e(this).closest(".select-mania"),n=i.data("selectMania-originalSelect");t.clear(i),n.trigger("change"),t.updateClean(i)},clearValue:function(a){a.stopPropagation();var i=e(this).closest(".select-mania"),n=e(this).closest(".select-mania-value");i.find('.select-mania-item[data-value="'+n.attr("data-value")+'"]').removeClass("select-mania-selected"),n.remove();var l=i.data("selectMania-originalSelect");t.removeMultipleVal(l,n.attr("data-value")),l.trigger("change"),t.updateClean(i)},selectItem:function(){var a=e(this).closest(".select-mania"),l=a.data("selectMania-originalSelect");if(!e(this).is(".select-mania-selected")){var s=e(this).attr("data-value"),c=i.buildValue({value:s,text:e(this).text()});a.is(".select-mania-multiple")?(a.find(".select-mania-values").append(c),t.addMultipleVal(l,s)):(a.find(".select-mania-item").removeClass("select-mania-selected"),a.find(".select-mania-values .select-mania-value").remove(),a.find(".select-mania-values").append(c),l.val(s)),e(this).addClass("select-mania-selected"),l.trigger("change")}a.is(".select-mania-multiple")||t.closeDropdown(a.find(".select-mania-dropdown")),t.updateClean(a),n.bind(a)},inputSearch:function(){$selectManiaEl=e(this).closest(".select-mania");var a=200;$selectManiaEl.is(".select-mania-ajax")&&(a=400),clearTimeout(e(this).data("selectMania-searchTimer")),e(this).data("selectMania-searchTimer",setTimeout(function(){$selectManiaEl.is(".select-mania-ajax")?t.doSearchAjax($selectManiaEl):t.doSearch($selectManiaEl)},a))},scrollAjax:function(a){var i=e(this),l=i.closest(".select-mania");if(!0!==l.data("selectMania-ajaxScrollDone")&&i.scrollTop()>=i[0].scrollHeight-i.outerHeight()-12&&!0===l.data("selectMania-ajaxReady")){var s=l.data("selectMania-ajaxPage")+1,c=l.find(".select-mania-dropdown-search-input").first().val();l.data("selectMania-ajaxReady",!1),l.data("selectMania-ajaxPage",s),t.dropdownLoading(l),l.data("selectMania-ajaxFunction")(c,s,l.data("selectMania-ajaxData"),function(e){t.dropdownLoading(l,!0),""!==e.trim()?(t.addItems(l,e),n.bind(l),l.data("selectMania-ajaxReady",!0)):l.data("selectMania-ajaxScrollDone",!0)})}},scrollControl:function(a){var t=e(this);return a.originalEvent.deltaY<0?t.scrollTop()>0:t.scrollTop()+t.innerHeight()<t[0].scrollHeight}},l={def:function(e){return void 0===e?null:e}},s={init:function(i){var n=e.extend(!0,{},a.defaults,i);return this.each(function(){var a=e(this);t.controlTarget(a,["isSelect","notInitialized"])&&t.initialize(a,n)})},update:function(){return this.each(function(){var a=e(this);t.controlTarget(a,["isInitialized"])&&t.update(a)})},destroy:function(){return this.each(function(){var a=e(this);t.controlTarget(a,["isInitialized"])&&t.destroy(a)})},check:function(){if(t.controlTarget(this,["isSingle"]))return this.hasClass("select-mania-original")},get:function(){if(t.controlTarget(this,["isSingle","isInitialized"])){var e=this.data("selectMania-element");return t.getVal(e)}},set:function(e){if(t.controlTarget(this,["isSingle","isInitialized"])&&t.controlValues(this,e)){var a=this.data("selectMania-element");t.setVal(a,e)}},clear:function(){return this.each(function(){var a=e(this);if(t.controlTarget(a,["isInitialized"])){var i=a.data("selectMania-element");t.clear(i),a.trigger("change"),t.updateClean(i)}})},setup:function(){return this.each(function(){var a=e(this);if(t.controlTarget(a,["isInitialized"])){var i=a.data("selectMania-element");t.clear(i),a.trigger("change"),t.updateClean(i)}})}};e.fn.selectMania=function(e){if(!(this.length<1)){if(s[e]){var a=Array.prototype.slice.call(arguments,1);return s[e].apply(this,a)}if("object"==typeof e||!e)return s.init.apply(this,arguments);console.error("selectMania | wrong method called"),console.log(this)}},e.extend({selectManiaSetup:function(e){a.setup(e)}})}(jQuery);